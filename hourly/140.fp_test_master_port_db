#!/bin/sh -
#
# FreshPorts periodic script
#
# Verifies that the FreshPorts database has sysutils/bacula-server as the
# master port for bacula-client
#

# If there is a global system configuration file, suck it in.
#
logger -p local3.notice -t FreshPorts "into $0"
if [ -r /etc/defaults/periodic.conf ]
then
	. /etc/defaults/periodic.conf
	source_periodic_confs
fi

# assign default values
fp_scripts_dir=${fp_scripts_dir:-/usr/local/libexec/freshports}
fp_freshports_user=${fp_freshports_user:-freshports}

case "$fp_test_master_port_db_enable" in
	[Yy][Ee][Ss])
	logger -p local3.notice -t FreshPorts into 140.fp_test_master_port_db
	echo "cd $fp_scripts_dir && /usr/local/bin/perl test-master-port.pl" | su -fm $fp_freshports_user || rc=3
	;;

	*)  rc=0;;
esac

exit $rc
